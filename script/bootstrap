#!/usr/bin/env bash

function bootstrap {
  local shome="$(cd -P -- "${BASH_SOURCE%/*}/.." && pwd -P)"
  source "$shome/script/profile"

  case "$(uname -s)" in
    Darwin)
      brew cask install java
      ;;
    Linux)
      local platform='-linux-x64.tar.gz'
      
      if [[ ! -f "/data/cache/nodist/${JAVA_VERSION}$platform" ]]; then
        wget -c -O "/data/cache/nodist/${JAVA_VERSION}$platform" --no-check-certificate --no-cookies --header "Cookie: oraclelicense=accept-securebackup-cookie" "${JAVA_URL}${platform}"
      fi

      mkdir -p vendor
      pushd vendor
      tar xfz "/data/cache/nodist/${JAVA_VERSION}$platform"
      popd
      ;;
  esac
}

bootstrap
