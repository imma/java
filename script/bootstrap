#!/usr/bin/env bash

function bootstrap {
  local shome="$(cd -P -- "${BASH_SOURCE%/*}/.." && pwd -P)"
  source "$shome/script/profile"

  case "${DISTRIB_ID}" in
    Darwin)
      brew cask install java
      ;;
    *)
      local platform='-linux-x64.tar.gz'
      
      if [[ ! -f "${DATA}/cache/nodist/${JAVA_VERSION}$platform" ]]; then
        wget -c -O "${DATA}/cache/nodist/${JAVA_VERSION}$platform" --no-check-certificate --no-cookies --header "Cookie: oraclelicense=accept-securebackup-cookie" "${JAVA_URL}${platform}"
      fi

      mkdir -p "$shome/vendor"
      pushd "$shome/vendor"
      tar xfz "${DATA}/cache/nodist/${JAVA_VERSION}$platform"
      popd
      ;;
  esac
}

bootstrap
